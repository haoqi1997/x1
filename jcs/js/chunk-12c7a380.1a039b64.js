(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12c7a380"],{"355e":function(e,t,i){"use strict";var s=i("d8c2"),r=i.n(s);r.a},a93c:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"buttons"},[i("div",{staticClass:"buttons"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:7}},[i("el-input",{attrs:{placeholder:"请输入标题",clearable:""},on:{clear:e.getUFineArtsList},model:{value:e.FineArtstitle,callback:function(t){e.FineArtstitle=t},expression:"FineArtstitle"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUFineArtsList},slot:"append"})],1)],1),i("el-col",{attrs:{span:4,id:"user_add"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.addFineArts}},[e._v("公益慈善")])],1)],1)],1)]),i("div",{staticClass:"mian"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.ofloading,expression:"ofloading"}],staticStyle:{width:"100%"},attrs:{data:e.FineArtsData,"row-class-name":"warning-row",border:"","element-loading-text":"正在获取列表，请稍等..."}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),i("el-table-column",{attrs:{prop:"title",label:"标题"}}),i("el-table-column",{attrs:{prop:"synopsis",label:"简介"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(i){return e.handleEdit(t.$index,t.row.id)}}}),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(i){return e.handleDelete(t.$index,t.row.id)}}})]}}])})],1),i("CtrlPage",{directives:[{name:"show",rawName:"v-show",value:0<e.FineArtsData.length,expression:"0 < FineArtsData.length"}],ref:"page",attrs:{setPage:e.getList}})],1),i("el-dialog",{attrs:{title:"公益慈善",visible:e.FineArtsDataVisible,width:"50%"},on:{"update:visible":function(t){e.FineArtsDataVisible=t}}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入活动标题"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),i("el-form-item",{attrs:{label:"简介",prop:"synopsis"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入简介"},model:{value:e.ruleForm.synopsis,callback:function(t){e.$set(e.ruleForm,"synopsis",t)},expression:"ruleForm.synopsis"}})],1),i("el-form-item",{attrs:{label:"上传照片",prop:"picture"}},[i("el-input",{staticStyle:{display:"none !important"},model:{value:e.ruleForm.picture,callback:function(t){e.$set(e.ruleForm,"picture",t)},expression:"ruleForm.picture"}}),i("el-upload",{attrs:{action:e.uploadUrl,"list-type":"picture-card","on-success":e.FineArtsSuccess,headers:e.importHeaders,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,name:"files",limit:1,"file-list":e.FineArtsFilesList,"before-upload":e.beforeAvatarUpload}},[i("i",{staticClass:"el-icon-plus"})]),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),i("div",{staticStyle:{"margin-top":"50px",position:"relative"}},[i("el-button",{staticStyle:{position:"absolute",right:"0"},attrs:{type:"primary",size:"small"},on:{click:e.uploads}},[e._v("上传照片")]),i("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.ruleForm.detailHtml,callback:function(t){e.$set(e.ruleForm,"detailHtml",t)},expression:"ruleForm.detailHtml"}})],1),i("el-dialog",{attrs:{width:"30%",title:"上传图片",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[i("el-upload",{attrs:{action:e.uploadUrl,"list-type":"picture-card","on-success":e.editorSuccess,headers:e.importHeaders,"on-preview":e.handlePictureCardPreview,name:"files","file-list":e.editorimgFilesList,"before-upload":e.beforeAvatarUpload}},[i("i",{staticClass:"el-icon-plus"})]),i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}}),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.innerVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.Success}},[e._v("确 定")])],1)],1),i("el-form-item",{staticStyle:{"margin-top":"30px"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),i("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("取消")])],1)],1)],1),i("el-dialog",{attrs:{title:"编辑活动",visible:e.FineArts,width:"50%"},on:{"update:visible":function(t){e.FineArts=t}}},[i("el-form",{ref:"Form",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),i("el-form-item",{attrs:{label:"简介",prop:"synopsis"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入简介"},model:{value:e.ruleForm.synopsis,callback:function(t){e.$set(e.ruleForm,"synopsis",t)},expression:"ruleForm.synopsis"}})],1),i("el-form-item",{attrs:{label:"上传照片",prop:"picture"}},[i("el-input",{staticStyle:{display:"none !important"},attrs:{placeholder:"请选择协办单位"},model:{value:e.ruleForm.picture,callback:function(t){e.$set(e.ruleForm,"picture",t)},expression:"ruleForm.picture"}}),i("el-upload",{ref:"uplo",attrs:{action:e.uploadUrl,"list-type":"picture-card","on-success":e.FineArtsSuccess,headers:e.importHeaders,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,name:"files",limit:1,"file-list":e.FineArtsFilesList,"before-upload":e.beforeAvatarUpload}},[i("i",{staticClass:"el-icon-plus"})]),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),i("div",{staticStyle:{"margin-top":"50px",position:"relative"}},[i("el-button",{staticStyle:{position:"absolute",right:"0"},attrs:{type:"primary",size:"small"},on:{click:e.uploads}},[e._v("上传照片")]),i("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.ruleForm.detailHtml,callback:function(t){e.$set(e.ruleForm,"detailHtml",t)},expression:"ruleForm.detailHtml"}})],1),i("el-dialog",{attrs:{width:"30%",title:"上传图片",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[i("el-upload",{attrs:{action:e.uploadUrl,"list-type":"picture-card","on-success":e.editorSuccess,headers:e.importHeaders,"on-preview":e.handlePictureCardPreview,name:"files","file-list":e.editorimgFilesList,"before-upload":e.beforeAvatarUpload}},[i("i",{staticClass:"el-icon-plus"})]),i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}}),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.innerVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.Success}},[e._v("确 定")])],1)],1),i("el-form-item",{staticStyle:{"margin-top":"30px"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.redactForm("Form")}}},[e._v("确认编辑")]),i("el-button",{on:{click:function(t){return e.resetForm("Form")}}},[e._v("取消")])],1)],1)],1)],1)},r=[],l=(i("4160"),i("159b"),i("ed35")),o=i("5f87"),a={name:"",data:function(){return{FineArtsDataVisible:!1,dialogImageUrl:"",ofloading:!0,FineArts:!1,FineArtsData:[],editorimg:[],editorimgFilesList:[],dialogVisible:!1,FineArtsFilesList:[],FineArtstitle:"",ids:"",innerVisible:!1,Dateshijian:"",ruleForm:{picture:"",synopsis:"",title:"",typeCode:"charityevent",detailHtml:""},uploadUrl:"".concat(window.apiBase,"/file/uploadFiles"),importHeaders:{token:Object(o["a"])().token},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],synopsis:[{required:!0,message:"请输入简介",trigger:"blur"}],picture:[{required:!0,message:"请上传照片"}]},editorOption:{},quilllength:""}},created:function(){},mounted:function(){this.$refs.page.getList(1)},methods:{editorSuccess:function(e){console.log("editorSuccess -> res",e),this.editorimg.push(e.data[0])},uploads:function(){var e=this.$refs.myQuillEditor.quill;this.quilllength=e.getSelection()?e.getSelection().index:0,console.log("uploads -> this.quilllength",this.quilllength),this.innerVisible=!0},beforeAvatarUpload:function(e){var t=e.size/1024/1024<1;return t||this.$message.error("上传图片大小不能超过 1MB!"),t},handleEdit:function(e,t){var i=this;this.ids=t,this.FineArtsFilesList=[],this.$public.happeningController.happeningid(t).then((function(e){"000000"==e.code&&(i.ruleForm=e.data,i.FineArtsFilesList.push({url:e.data.picture,name:e.data.title,id:e.data.id}),i.FineArts=!0)}))},FineArtsSuccess:function(e){this.ruleForm.picture=e.data[0]},getUFineArtsList:function(){this.$refs.page.getList(1)},addFineArts:function(){this.ruleForm={picture:"",synopsis:"",title:"",typeCode:"charityevent",detailHtml:""},this.FineArtsFilesList=[],this.FineArtsDataVisible=!0},Success:function(){var e=this;this.innerVisible=!1,this.editorimg.forEach((function(t){var i=t,s=e.$refs.myQuillEditor.quill;i?(s.insertEmbed(e.quilllength,"image",i),s.setSelection(e.quilllength+1),e.editorimgFilesList=[]):Message.error("图片插入失败")}))},getList:function(e,t,i){var s=this;this.$public.happeningController.happeningConditions({current:e,size:t,title:this.FineArtstitle,typeCode:"charityevent"}).then((function(e){"000000"==e.code&&(s.FineArtsData=e.data.records,s.ofloading=!1,i(s.FineArtsData,+e.data.total))}))},submitForm:function(e){var t=this;console.log("submitForm -> this.ruleForm",this.ruleForm),this.$refs[e].validate((function(i){if(!i)return console.log("error submit!!"),!1;t.$public.happeningController.addhappening(t.ruleForm).then((function(i){"000000"==i.code&&(t.$$message({message:"添加成功！",type:"success"}),t.$refs[e].resetFields(),t.$refs.page.getList(1),t.FineArtsDataVisible=!1)}))}))},redactForm:function(e){var t=this;console.log("redactForm -> formName",e);var i={detailHtml:this.ruleForm.detailHtml,picture:this.ruleForm.picture,synopsis:this.ruleForm.synopsis,title:this.ruleForm.title,typeCode:"charityevent"};this.$refs[e].validate((function(s){if(!s)return console.log("error submit!!"),!1;t.$public.happeningController.puthappeningid(t.ids,i).then((function(i){"000000"==i.code&&(t.$$message({message:"修改成功！",type:"success"}),t.$refs[e].resetFields(),t.$refs.page.getList(1),t.FineArts=!1)}))}))},resetForm:function(e){this.FineArts=!1,this.FineArtsDataVisible=!1,this.$refs[e].resetFields()},handlePictureCardPreview:function(e){console.log("handlePictureCardPreview -> file",e),this.dialogImageUrl=e.url,this.dialogVisible=!0},handleRemove:function(e,t){this.ruleForm.picture=""},handleDelete:function(e,t){var i=this;this.$confirm("此操作将永久删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.$public.happeningController.DELETEhappening(t).then((function(e){console.log("handleDelete -> res",e),"000000"==e.code&&(i.$message({message:"恭喜你，删除成功",type:"success"}),i.$refs.page.getList(1))}))})).catch((function(){i.$message({type:"info",message:"已取消删除"})}))}},components:{CtrlPage:l["a"]}},n=a,u=(i("355e"),i("2877")),c=Object(u["a"])(n,s,r,!1,null,null,null);t["default"]=c.exports},d8c2:function(e,t,i){},ed35:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":e.pageSizes,"page-size":e.rows,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"prev-text":"上一页","next-text":"下一页"},on:{"size-change":e.onSizeChange,"current-change":e.onCurrentChange}})},r=[],l=(i("a9e3"),{props:{pageSizes:{type:Array,default:function(){return[5,10,20,50,100]}},rows:{type:Number,default:10},setPage:{type:Function}},watch:{rows:function(){this.currentRows=this.rows}},data:function(){return{currentRows:this.rows,pageIndex:1,total:0}},methods:{onSizeChange:function(e){this.currentRows=e,this.getList(1)},onCurrentChange:function(e){this.getList(e)},setResultCallback:function(e,t){0==e.length&&this.pageIndex>1?this.getList(this.pageIndex-1):this.total=t},getList:function(e){this.setPage&&(this.pageIndex=e,this.setPage(e,this.currentRows,this.setResultCallback))},refresh:function(){this.getList(this.pageIndex)}}}),o=l,a=i("2877"),n=Object(a["a"])(o,s,r,!1,null,null,null);t["a"]=n.exports}}]);