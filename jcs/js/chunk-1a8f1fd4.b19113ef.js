(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a8f1fd4"],{"0818":function(e,t,l){},"108a":function(e,t,l){"use strict";l.r(t);var i=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("div",{staticClass:"buttons"},[l("div",{staticClass:"buttons"},[l("el-row",{attrs:{gutter:20}},[l("el-col",{attrs:{span:7}},[l("el-input",{attrs:{placeholder:"请输入标题",clearable:""},on:{clear:e.getUMethodList},model:{value:e.Methodname,callback:function(t){e.Methodname=t},expression:"Methodname"}},[l("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUMethodList},slot:"append"})],1)],1),l("el-col",{attrs:{span:4,id:"user_add"}},[l("el-button",{attrs:{type:"primary"},on:{click:e.addMethod}},[e._v("添加人物")])],1)],1)],1)]),l("div",{staticClass:"mian"},[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.ofloading,expression:"ofloading"}],staticStyle:{width:"100%"},attrs:{data:e.MethodData,"row-class-name":"warning-row",border:"","element-loading-text":"正在获取列表，请稍等..."}},[l("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),l("el-table-column",{attrs:{prop:"type",label:"类型"}}),l("el-table-column",{attrs:{prop:"name",label:"名字"}}),l("el-table-column",{attrs:{prop:"generation",label:"第几代"}}),l("el-table-column",{attrs:{prop:"beginYear",label:"开始时间"}}),l("el-table-column",{attrs:{prop:"endYear",label:"结束时间"}}),l("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(l){return e.handleEdit(t.$index,t.row.id)}}}),l("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(l){return e.handleDelete(t.$index,t.row.id)}}})]}}])})],1),l("CtrlPage",{directives:[{name:"show",rawName:"v-show",value:0<e.MethodData.length,expression:"0 < MethodData.length"}],ref:"page",attrs:{setPage:e.getList}})],1),l("el-dialog",{attrs:{title:"添加人物",visible:e.MethodDataVisible,width:"50%"},on:{"update:visible":function(t){e.MethodDataVisible=t}}},[l("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"选择类型",prop:"type"}},[l("el-select",{attrs:{clearable:"",placeholder:"请选择类型"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},e._l(e.options,(function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.vshow,expression:"vshow"}],attrs:{label:"第几代",prop:"generationNum"}},[l("el-input",{attrs:{placeholder:"请输入几代"},model:{value:e.ruleForm.generationNum,callback:function(t){e.$set(e.ruleForm,"generationNum",t)},expression:"ruleForm.generationNum"}})],1),l("el-form-item",{attrs:{label:"名字",prop:"name"}},[l("el-input",{attrs:{placeholder:"请输入名字"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),l("el-form-item",{attrs:{label:"开始时间"}},[l("el-input",{attrs:{placeholder:"请输入开始时间"},model:{value:e.ruleForm.beginYear,callback:function(t){e.$set(e.ruleForm,"beginYear",t)},expression:"ruleForm.beginYear"}})],1),l("el-form-item",{attrs:{label:"结束时间"}},[l("el-input",{attrs:{placeholder:"请输入结束时间"},model:{value:e.ruleForm.endYear,callback:function(t){e.$set(e.ruleForm,"endYear",t)},expression:"ruleForm.endYear"}})],1),l("el-form-item",{attrs:{label:"上传照片"}},[l("el-upload",{class:{hide:e.hideUpload},attrs:{action:e.uploadUrl,"list-type":"picture-card","on-success":e.MethodSuccess,headers:e.importHeaders,"on-remove":e.handleRemove,name:"files","on-change":e.handleChange,"file-list":e.MethodFilesList,"before-upload":e.beforeAvatarUpload}},[l("i",{staticClass:"el-icon-plus"})]),l("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[l("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),l("div",{staticStyle:{"margin-top":"50px",position:"relative"}},[l("el-button",{staticStyle:{position:"absolute",right:"0"},attrs:{type:"primary",size:"small"},on:{click:e.uploads}},[e._v("上传照片")]),l("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.ruleForm.detailHtml,callback:function(t){e.$set(e.ruleForm,"detailHtml",t)},expression:"ruleForm.detailHtml"}})],1),l("el-dialog",{attrs:{width:"30%",title:"上传图片",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[l("el-upload",{attrs:{action:e.uploadUrl,"list-type":"picture-card","on-success":e.editorSuccess,headers:e.importHeaders,name:"files","file-list":e.editorimgFilesList,"before-upload":e.beforeAvatarUpload}},[l("i",{staticClass:"el-icon-plus"})]),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.innerVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.Success}},[e._v("确 定")])],1)],1),l("el-form-item",{staticStyle:{"margin-top":"30px"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),l("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("取消")])],1)],1)],1),l("el-dialog",{attrs:{title:"编辑人物",visible:e.Method,width:"50%"},on:{"update:visible":function(t){e.Method=t}}},[l("el-form",{ref:"Form",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"选择类型",prop:"type"}},[l("el-select",{attrs:{clearable:"",placeholder:"请选择类型"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},e._l(e.options,(function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.vshow,expression:"vshow"}],attrs:{label:"第几代",prop:"generationNum"}},[l("el-input",{attrs:{placeholder:"请输入几代"},model:{value:e.ruleForm.generationNum,callback:function(t){e.$set(e.ruleForm,"generationNum",t)},expression:"ruleForm.generationNum"}})],1),l("el-form-item",{attrs:{label:"名字",prop:"name"}},[l("el-input",{attrs:{placeholder:"请输入名字"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),l("el-form-item",{attrs:{label:"开始时间"}},[l("el-input",{attrs:{placeholder:"请输入开始时间"},model:{value:e.ruleForm.beginYear,callback:function(t){e.$set(e.ruleForm,"beginYear",t)},expression:"ruleForm.beginYear"}})],1),l("el-form-item",{attrs:{label:"结束时间"}},[l("el-input",{attrs:{placeholder:"请输入结束时间"},model:{value:e.ruleForm.endYear,callback:function(t){e.$set(e.ruleForm,"endYear",t)},expression:"ruleForm.endYear"}})],1),l("el-form-item",{attrs:{label:"上传照片",prop:"picture"}},[l("el-input",{staticStyle:{display:"none !important"},attrs:{placeholder:"请选择协办单位"},model:{value:e.ruleForm.picture,callback:function(t){e.$set(e.ruleForm,"picture",t)},expression:"ruleForm.picture"}}),l("el-upload",{ref:"uplo",class:{hide:e.hideUpload},attrs:{action:e.uploadUrl,"list-type":"picture-card","on-success":e.MethodSuccess,headers:e.importHeaders,"on-remove":e.handleRemove,name:"files","file-list":e.MethodFilesList,"before-upload":e.beforeAvatarUpload}},[l("i",{staticClass:"el-icon-plus"})])],1),l("div",{staticStyle:{"margin-top":"50px",position:"relative"}},[l("el-button",{staticStyle:{position:"absolute",right:"0"},attrs:{type:"primary",size:"small"},on:{click:e.uploads}},[e._v("上传照片")]),l("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.ruleForm.detailHtml,callback:function(t){e.$set(e.ruleForm,"detailHtml",t)},expression:"ruleForm.detailHtml"}})],1),l("el-dialog",{attrs:{width:"30%",title:"上传图片",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[l("el-upload",{attrs:{action:e.uploadUrl,"list-type":"picture-card","on-success":e.editorSuccess,headers:e.importHeaders,name:"files","file-list":e.editorimgFilesList,"before-upload":e.beforeAvatarUpload}},[l("i",{staticClass:"el-icon-plus"})]),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.innerVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.Success}},[e._v("确 定")])],1)],1),l("el-form-item",{staticStyle:{"margin-top":"30px"}},[l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.redactForm("Form")}}},[e._v("确认编辑")]),l("el-button",{on:{click:function(t){return e.resetForm("Form")}}},[e._v("取消")])],1)],1)],1)],1)},r=[],o=(l("4160"),l("b0c0"),l("159b"),l("ed35")),a=l("5f87"),s={name:"",data:function(){return{MethodDataVisible:!1,dialogImageUrl:"",ofloading:!0,Method:!1,MethodData:[],editorimg:[],editorimgFilesList:[],dialogVisible:!1,MethodFilesList:[],Methodname:"",ids:"",innerVisible:!1,Dateshijian:"",ruleForm:{beginYear:"",detailHtml:"",endYear:"",generationNum:"",name:"",picture:"",type:"",username:""},options:[{value:"1",label:"主持"},{value:"0",label:"法嗣"}],vshow:!0,uploadUrl:"".concat(window.apiBase,"/file/uploadFiles"),importHeaders:{token:Object(a["a"])().token},rules:{name:[{required:!0,message:"请输入名字",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"blur"}]},editorOption:{},quilllength:"",hideUpload:!1,limitCount:1}},watch:{"ruleForm.type":function(){console.log("ruleForm.type",this.ruleForm.type),0==this.ruleForm.type?(this.vshow=!1,console.log("this.vshow",this.vshow)):(this.vshow=!0,console.log("this.vshow",this.vshow))}},created:function(){},mounted:function(){this.$refs.page.getList(1)},methods:{handleChange:function(e,t){this.hideUpload=t.length>=this.limitCount},editorSuccess:function(e){this.editorimg.push(e.data[0])},uploads:function(){var e=this.$refs.myQuillEditor.quill;this.quilllength=e.getSelection()?e.getSelection().index:0,this.innerVisible=!0},beforeAvatarUpload:function(e){var t=e.size/1024/1024<10;return t||this.$message.error("上传图片大小不能超过 10MB!"),t},handleEdit:function(e,t){var l=this;this.ids=t,this.vshow=!0,this.MethodFilesList=[],this.$public.masterController.aumaster(t).then((function(e){"000000"==e.code&&(l.ruleForm=e.data,l.MethodFilesList.push({url:e.data.picture,name:e.data.name,id:e.data.id}),l.Method=!0)}))},MethodSuccess:function(e){this.ruleForm.picture=e.data[0]},getUMethodList:function(){this.$refs.page.getList(1)},addMethod:function(){this.hideUpload=!1,this.ruleForm={beginYear:"",detailHtml:"",endYear:"",generationNum:"",name:"",picture:"",type:""},this.vshow=!0,this.MethodFilesList=[],this.MethodDataVisible=!0},Success:function(){var e=this;this.innerVisible=!1,this.editorimg.forEach((function(t){var l=t,i=e.$refs.myQuillEditor.quill;l?(i.insertEmbed(e.quilllength,"image",l),i.setSelection(e.quilllength+1),e.editorimgFilesList=[]):Message.error("图片插入失败")})),this.editorimg=[]},getList:function(e,t,l){var i=this;this.$public.masterController.masterConditions({current:e,size:t,name:this.Methodname}).then((function(e){"000000"==e.code&&(i.MethodData=e.data.records,i.MethodData.forEach((function(e,t){1==e.type?i.MethodData[t].type="主持":i.MethodData[t].type="法嗣"})),i.ofloading=!1,l(i.MethodData,+e.data.total))}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(l){return l?(console.log("submitForm -> this.ruleForm.type",t.ruleForm.type),1==t.ruleForm.type&&""==t.ruleForm.generationNum?(t.$message.error("请填写年代"),!1):void t.$public.masterController.adsmaster(t.ruleForm).then((function(l){"000000"==l.code&&(t.$$message({message:"添加成功！",type:"success"}),t.$refs[e].resetFields(),t.$refs.page.getList(1),t.MethodDataVisible=!1,t.vshow=!0)}))):(console.log("error submit!!"),!1)}))},redactForm:function(e){var t=this,l={beginYear:this.ruleForm.beginYear,detailHtml:this.ruleForm.detailHtml,endYear:this.ruleForm.endYear,generationNum:this.ruleForm.generationNum,name:this.ruleForm.name,picture:this.ruleForm.picture,type:this.ruleForm.type};this.$refs[e].validate((function(i){if(!i)return console.log("error submit!!"),!1;t.$public.masterController.putmaster(t.ids,l).then((function(l){"000000"==l.code&&(t.$$message({message:"修改成功！",type:"success"}),t.$refs[e].resetFields(),t.$refs.page.getList(1),t.Method=!1,t.vshow=!0)}))}))},resetForm:function(e){this.Method=!1,this.MethodDataVisible=!1,this.$refs[e].resetFields()},handleRemove:function(e,t){this.ruleForm.picture="",this.hideUpload=t.length>=this.limitCount},handleDelete:function(e,t){var l=this;this.$confirm("此操作将永久删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l.$public.masterController.DELETEmaster(t).then((function(e){"000000"==e.code&&(l.$message({message:"恭喜你，删除成功",type:"success"}),l.$refs.page.getList(1))}))})).catch((function(){l.$message({type:"info",message:"已取消删除"})}))}},components:{CtrlPage:o["a"]}},n=s,u=(l("736d"),l("2877")),c=Object(u["a"])(n,i,r,!1,null,null,null);t["default"]=c.exports},"736d":function(e,t,l){"use strict";var i=l("0818"),r=l.n(i);r.a},ed35:function(e,t,l){"use strict";var i=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":e.pageSizes,"page-size":e.rows,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"prev-text":"上一页","next-text":"下一页"},on:{"size-change":e.onSizeChange,"current-change":e.onCurrentChange}})},r=[],o=(l("a9e3"),{props:{pageSizes:{type:Array,default:function(){return[5,10,20,50,100]}},rows:{type:Number,default:10},setPage:{type:Function}},watch:{rows:function(){this.currentRows=this.rows}},data:function(){return{currentRows:this.rows,pageIndex:1,total:0}},methods:{onSizeChange:function(e){this.currentRows=e,this.getList(1)},onCurrentChange:function(e){this.getList(e)},setResultCallback:function(e,t){0==e.length&&this.pageIndex>1?this.getList(this.pageIndex-1):this.total=t},getList:function(e){this.setPage&&(this.pageIndex=e,this.setPage(e,this.currentRows,this.setResultCallback))},refresh:function(){this.getList(this.pageIndex)}}}),a=o,s=l("2877"),n=Object(s["a"])(a,i,r,!1,null,null,null);t["a"]=n.exports}}]);